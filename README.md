
# Cервис покупки товаров для авторизованных пользователей
Данный проект организует и автоматизирует процесс создания и управления товарами, с целью привлечения новых клиентов.
Реализован на языке программирования Python с использованием фреймворка Fast API и БД PostgreSQL


## Реализация задачи:
FastAPI backend на Python. В качестве БД использовать PostgreSQL.
FastAPI - для реализации использовать фреймворк FastAPI
Tortoise ORM - Использование специальной библиотеки Tortoise для работы с СУБД, без написания SQL запросов вручную
Git - Использовать для хранения исходного кода один из удаленных Git репозиториев
Swagger - Для API серверов реализовать доступ к автогенерируемой документации
Redme - Описать документацию в файле Readme в корне проекта
PEP8 - Следовать рекомендациям PEP8

Требуемый функционал
Регистрация: ФИО, email (уникальный), телефон (уникальный), пароль, подтверждение пароля. Все поля обязательны.
Пароль должен быть не менее 8 символов, только латиница, минимум 1 символ верхнего регистра, минимум 1 спец символ $%&!:. 
Телефон должен удовлетворять маске: начинаться с +7 после чего идет 10 цифр.
Авторизация: email (одно поле), пароль. 

Для авторизованных пользователей доступна таблица товаров, где выводится список всех активных товаров в базе данных
Товар: имя(строка), цена(целое), созданное_at(дата-время), обновленное_at(дата-время), is_active(bool)

Для неавторизованных пользователей доступны регистрация, авторизация При попытке получить данные без доступа выводить ошибку {code: 401, message:”Unauthorized”}, с HTTP statuscode 401

Доп. задача:
Должен быть реализован объект Корзина (list[Товар]), в котором можно через getter получить общую стоимость корзины, реализовать методы добавления (одного или нескольких, используя @overload), удаления товара\полную очистку. Вывод корзины и работу с ней реализовывать не обязательно, достаточно только класса
Методы доступные авторизованным пользователям: список пагинированных товаров

Желательно использовать асинхронность

Идентификация пользователя должна происходить по Bearer токену.



## Структура кода проекта, выполненного на Python:
### app (основное приложение)
  #### app/__init__.py: пустой файл
  #### app/app_main.py: Главный файл FastAPI, в котором создается экземпляр FastAPI, регистрируются маршруты API и документации
  #### app/app_api.py: Основные API маршруты для работы с пользователями и товарами.
  #### app/app_services.py: Сервисы для выполнения бизнес-логики, такие как создание пользователя и получение списка товаров.
  #### app/app_models.py: Определение моделей данных для пользователей и товаров.
  #### app/cart: (корзина) для определения классов ShoppingCart и Product.
  #### app/cart_routes: код для маршрутов корзины.
  #### app/auth: вложенная папка:
     app/auth/auth_api.py: API маршруты для регистрации и аутентификации  пользователей.
     app/auth/auth_services.py: Сервисы для аутентификации и получения текущего пользователя.
     app/auth/auth_models.py: Модели данных, связанные с аутентификацией (например, токены).
### tests: Папка с тестами
  #### conftest.py: Файл загрузки настроек, тестовой инициализации приложения и базы данных, фикстур для отдельных тестов
  #### test_main.py: файл с тестами для эндпоинтов регистрации/авторизации пользователя и работы с товарами
### .aerich.ini: файл с настройками aerich alembic, generator, postgresql (не подгружается в репозиторий Git).
### run.py: Файл - точка входа и запуска приложения
### __init__.py: Пустой файл
### __main__.py.py: Пустой файл
### migrations: Папка с миграциями aerich для моделей и БД.
### pyproject.toml
### tortoise_config.py: Файл с моделью и настройками TORTOISE_ORM
### tortoise_test_config.py: Файл конфигурации TORTOISE_TEST_CONFIG для тестирования
### settings.py: Настройки проекта, такие как URL подключения к базе данных и SECRET_KEY.
### .env: Файл с личными настройками (не подгружается в репозиторий Git).
### .env.sample: Файл с описанием необходимых личных настроек.
### requirements: Фреймворки для установки в виртуальное окружение.
### README.md: Описание проекта.



## Устновка и настройка проекта
> Скопируйте код проекта из репозитория на GitHab по следующей ссылке: https://github.com/sergy0077/Diplomny_project.git
> Создайте новый проект в Pycharm, настройте и активируйте виртуальное окружение командами: python -m venv venv и source venv/bin/activate
> Установите пакеты из файла requirements.txt с помощью команды: pip install -r requirements.txt 



## Выполните личные (конфиденциальные) настройки
> Создайте в корне проекта файл конфигурации .env со своими личными настройками по шаблону, указанному в .env.sample. 
> Заполните файл согласно вашим личным данным.
> Создайте базу данных в postgresql, при этом имя файла базы данных должно совпадать с именем, указанным в файле .env.



## Инициализация БД и миграции
> Инициализируйте файл конфигурации и задайте местоположение миграций командой: aerich init -t tortoise_config.TORTOISE_ORM
> Aerich - это инструмент для миграции базы данных для TortoiseORM, который аналогичен Alembic для SQLAlchemy или 
> встроенному решению миграций в Django ORM
> Инициализация базы данных PostgreSQL командой: aerich init-db
> Обновление моделей и создание миграции командой: aerich migrate
> Применение миграций (обновление до последней версии) командой: aerich upgrade



## Запуск приложения
Запустите проект файлом run.py
Переходите по ссылке: http://127.0.0.1:8000/ и начинайте использование проекта



## Отправка HTTP-запросов из командной строки или терминала Pycharm
Установите пакетный менеджер Homebrew. Для macOS команда: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
Установите программу curl с использованием пакетного менеджера Homebrew командой: brew install curl
Отправляйте HTTP-запросы к эндпоинтам приложения app из командной строки или терминала Pycharm, например, 
> запрос на регистрацию пользователя на платформе, подтверждая свою уникальность через электронную почт: curl -X POST "http://127.0.0.1:8000/register" -H "accept: application/json" -H "Content-Type: application/json" -d '{"full_name":"John Doe","email":"john.doe@example.com","phone":"123456789","password":"secretpassword"}'
> запрос на получение токена для обеспечения безопасности и уникальности аккаунтов: curl -X POST "http://127.0.0.1:8000/token" -H "accept: application/json" -H "Content-Type: application/x-www-form-urlencoded" -d "email=john.doe@example.com&password=secretpassword" 
> запрос на идентификацию пользователя по почте и паролю: curl -X GET "http://127.0.0.1:8000/users/me" -H "accept: application/json" -H "Authorization: Bearer eyJhbGciOiJIUzI1Ni
IsInR5cCI6IkpXVCJ9.eyJzdWIiOiJqb2huLmRvZUBleGFtcGxlLmNvbSIsImV4cCI6MTcwMjU4NzI0NX0.BNCoulfr4SlViJMDyllkr-viWBV_aF16qTYHVsx8igc" -d "email=john.doe@example.com&password=secretpassword"
> запрос на добавление товара в корзину: curl -X POST "http://127.0.0.1:8000/cart/add-to-cart" -H "accept: application/json" -H "Content-Type: application/json" -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJqb2huLmRvZUBleGFtcGxlLmNvbSIsImV4cCI6MTcwMjU4NzI0NX0.BNCoulfr4SlViJMDyllkr-viWBV_aF16qTYHVsx8igc" -d '{"product_name":"Product Name"}'
> и так далее по всем эндпоинтам. Данные действия можно реализовать также через Postman или другим способом, позволяющим формирование API-запросов к эндпоинтам



## Документация
Используйте доступ к автогенерируемой документации Swagger или Redoc для API-эндпоинтов по URL-адресам: 
http://127.0.0.1:8000/docs/ и http://127.0.0.1:8000/redoc/



## Тестирование
Проведите тестирование различных функциональностей вашего проекта командой pytest tests
Для проверки покрытия проекта тестами использовать команду: coverage report -m
Код должен быть покрыт тестами минимум на 75%. 






